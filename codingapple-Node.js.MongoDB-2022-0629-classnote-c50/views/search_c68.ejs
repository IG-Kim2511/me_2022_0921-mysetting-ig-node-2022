<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>class</title>

    <!--bootstrap  -->
    <link rel="stylesheet" href="bootstrap/bootstrap.min.css" />
    <script src="bootstrap/bootstrap.min.js" defer></script>
    <!-- jquery -->
    <script src="jQuery/jquery-3.4.1.min.js" defer></script>

    <!-- CSS, JS -->
    <link rel="stylesheet" href="../style.css" />
    <script src="script.js" defer></script>
  </head>
  <body>
    <!-- ğŸ¦„ğŸ‘»ğŸš€âš¡ğŸ‘‰ğŸ‰ -->

    <section>
      <p class="title">í„°ë¯¸ë„ ëª…ë ¹ì–´ ì •ë¦¬</p>
      <!-- 
       
       -->
    </section>
    <section class="c3">
      <p class="title"></p>
    </section>

    <!-- ğŸ¦„ğŸ¦„c22 Bootstrapì„ ì´ìš©í•œ ë¹ ë¥¸ UI ê°œë°œ -->

    <!-- ğŸ¥’c50      <%- include('nav_c50.html') %> -->
    <%- include('nav_c50.html') %>
    
    <!-- 
      <nav class="navbar">
        <div class="navbar__logo">
          <i class="fas fa-kiwi-bird"></i>
          <a href="">keiVenture</a>
        </div>
        <div class="navbar__menu">

          <li><a href="http://localhost:3000">home</a></li>
          <li><a href="http://localhost:3000/write">write</a></li>
          <li><a href="http://localhost:3000/list">list</a></li>
          <li><a href="/edit">edit</a></li>
          
        </div>
        <div class="navbar__icons">
          <li><i class="fab fa-odnoklassniki-square"></i></li>
          <li><i class="fas fa-skiing"></i></li>
        </div> 

        <a href="#" class="footer">
          <i class="fas fa-align-justify"></i>
        </a>
      </nav>
  -->




    <section>
      <h1>./views/list.ejs</h1>
    </section>
    <br><br><br>
    

    <!-- ğŸ¥’ğŸ¦„c66 -->    
    <!-- ğŸ‘‰script -->
    <div>
      <!-- id="search-input", id="search" -->
      <input type="text" id="search-input">
      <button id="search">search</button>
    </div>
    <br><br><br>
    
    <!--  -->
    <section>
        <h2>ğŸŒŠc32. ì„œë²„ì—ì„œ ê°€ì ¸ì˜¨ í• ì¼ ë¦¬ìŠ¤íŠ¸</h2>

        <!-- ğŸ¦„c34 -->
        <h4>í• ì¼ ì œëª© : <%= ig_posts %></h4>
        <p>í• ì¼ ë§ˆê°ë‚ ì§œ : <%= ig_posts %></p>    
        

        <br><br><br><br><br><br>
        <div>
            <h2 >ğŸŒŠc34 ë°˜ë³µë¬¸</h2>
            <!-- ğŸ¦„c34 ë°˜ë³µë¬¸     <%  %>   
                for (let i = 0; i < array.length; i++) {
                  const element = array[i];              
                }        
            -->
            <%    for (let i = 0; i < ig_posts.length; i++) {   %>  
              <div class="list">
                <p>_id: <%= ig_posts[i]._id  %>  </p>
                <h4>í• ì¼ ì œëª© : <%= ig_posts[i].ì œëª© %></h4>
                <p>í• ì¼ ë§ˆê°ë‚ ì§œ : <%= ig_posts[i].ë‚ ì§œ %></p>      

                <!-- ğŸ‘‰script. 44-40), 44-50) data-id="<%= ig_posts[i]._id %>-->
                <button class="myBtn delete" data-id="<%= ig_posts[i]._id %>">ì‚­ì œ</button>
                <button class="myBtn edit" data-id="<%= ig_posts[i]._id %>">edit</button>
                <button class="myBtn detail" data-id="<%= ig_posts[i]._id %>">detail page</button>
              </div>
            <%  }  %> 
        </div>
    </section>





    <!-- ğŸ¦„ğŸ¦„c42,44,46, AJAXë¡œ DELETE ìš”ì²­í•˜ê¸° -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

    <script>
   
      // ğŸ€44-40) ë²„íŠ¼í´ë¦­ & ì‹¤í–‰  ğŸ‘‰html
      $('.delete').click(function (e) {   

        // ğŸ€46-20) this : ì§€ê¸ˆ í´ë¦­í•œ ê²ƒ
        var thisClicked= $(this);
          
        //  ajaxìš”ì²­ì‹œ, /deleteì„œë²„ì— {_id:1}ì •ë³´ ë³´ë‚´ì¤Œ
        $.ajax({
            method: "DELETE",
            url: "/delete",
            // data: { _id : 7}      //ğŸ‘‰server.js , req.body

            //ğŸ€44-50. e.target.dataset.id : í´ë¦­í•œ ë²„íŠ¼ì— ìˆ¨ê²¨ì§„ data-idê°’ ê°€ì ¸ì˜¤ê¸°
            data:{_id : e.target.dataset.id}    
          })
          .done(function( msgê²°ê³¼ ) {                   //ğŸ¥’c46-30)
            console.log('c44. delete-success')
            // 46)
            /* 
              w1 : page ê°•ì œ ìƒˆë¡œê³ ì¹¨   -->  location.reload()
              w2 : ì‚­ì œë²„íŠ¼ í´ë¦­í•œ divë¥¼ ì œê±° or ì•ˆë³´ì´ê²Œí•¨          
            */

            // 46-20).parent('div').fadeOut();
            thisClicked.parent('div').fadeOut();

          }).fail(function (jqXHR, textStatus) {                  //ğŸ¥’c46-40)

            console.log('c44, delete-fail')
            console.log( "Request failed: " + textStatus );   
          });
      })


        // ğŸ€ detail button -> ë‚˜ì¤‘ì— ë§Œë“¤ê¸°

        $('.detail').click(function (e) {
                
          
        });


        //ğŸ¦„ğŸ¦„c66
        //ğŸ€c66-10). searchê¸°ëŠ¥ ë§Œë“¤ê¸°, query string ë§Œë“¬ (Query string parameters)
        /* ğŸ„
          -2) search btn click,       

          -6) ejs -> server.jsë¡œ  ë°ì´í„° ë³´ëƒ„ ë 

            6-a) POSTìš”ì²­ìœ¼ë¡œ ê¸°ëŠ¥ë§Œë“¤ê¸°. ë
            
            6-b) GETìš”ì²­ìœ¼ë¡œ ë§Œë“¤ì–´ë³´ê¸°  ğŸ‘‰ ì´ì œë¶€í„° í•  ì½”ë“œ ğŸ‘‰ "Query string parameters"ì‚¬ìš©í•¨
        */
        /* c66-10-6-b)
            ë²„íŠ¼ í´ë¦­, ì„œë²„ë¡œ getìš”ì²­ , Query string parameters

            Query string parameters : `/~~?value=${ig_search_inputê°’}`

            window.location.replace('/search'):  ë²„íŠ¼í´ë¦­ /searchë¡œ ì´ë™í•¨, ì‚¬ì‹¤ìƒ getìš”ì²­ê³¼ ê°™ìŒ 
        */
       $('#search').click(function () {           

        // $('#search-input').val() : input value 
        var ig_search_inputê°’ = $('#search-input').val()

        // window.location.replace('/search')
        // `/~~?value=${ig_search_inputê°’}`
        window.location.replace(`/search?value=${ig_search_inputê°’}`)

       })

    </script>
  </body>
</html>
